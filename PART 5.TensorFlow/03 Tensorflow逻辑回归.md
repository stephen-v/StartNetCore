# 03 Tensorflow 逻辑回归

## 3.1 逻辑回归原理
### 定义线性模型
在现实生活中，我们遇到的数据大多数都是非线性的，因此我们不能用上一章线性回归的方法来进行回归。但是我们仍然可以从线性模型着手开始第一步，首先对输入的数据进行加权求和。
**线性模型**：
$$z=w\bold{x}+b$$
其中w我们称为“权重”，b为偏置量（bias），$\bold{x}$为输入的样本数据，三者均为向量的形式。

我们先在二分类中来讨论，假如能创建一个模型，如果系统输出1，我们认为是第一类，如果系统输出0，我们认为是第二类，这种需求有点像阶跃函数（海维塞德阶跃函数），但是阶跃函数是间断函数，y的取值在x=0处突然跳跃到1，在实际的建模中，我们很难在模型中处理这种情况，所以总有伟大的数学家会给你想办法，那就是使用Sigmoid函数。
![2017-09-05-14-37-11](http://qiniu.xdpie.com/2017-09-05-14-37-11.png)

**Sigmoid函数**：
$$y=sigmoid(z)=\frac{1}{1+{e}^{-z}}$$
Sigmoid函数是激活函数其中的一种，当x=0时，函数值为0.5，随着x的增大，对应的Sigmoid值趋近1，而随着x的减小，Sigmoid值趋近0。通过这个函数，我们可以得到一系列0—1之间的数值，接着我们就可以把大于0.5的数据分为1类，把小于0.5的数据分为0类。

![2017-09-05-15-24-33](http://qiniu.xdpie.com/2017-09-05-15-24-33.png)


这种方式等价于是一种概率估计，我们把y看作服从伯努利分布，在给定x条件下，求解每个$y_i$为1或0的概率。此时，逻辑回归这个抽象的名词，在这里我们把它转化成了能够让人容易理解的概率问题。接着通过最大对数似然函数估计w值，就解决问题了。
$y_i$等于1的概率为：$$sigmoid(w{x_i}+b)$$
$y_i$等于0的概率为：$$1-sigmoid(w{x_i}+b)$$

以上对Sigmoid函数描述可以看出该函数多用于二分类，而我们会经常遇到多分类问题，这时，Softmax函数的价值就体现出来了。

**Softmax函数**：
$$softmax(z)_i=\frac{e^{z_i}}{\sum_{j}{e^{z_j}}}=\frac{e^{w{x_i}+b}}{\sum_{j}{e^{w{x_j}+b}}}$$
即：
$$y=softmax(wx+b)$$
Softmax函数也是激活函数的一种，主要用于多分类，把输入的线性模型当成幂指数求值，最后对不同的对象分配概率，通过概率来把对象分类，而每个对象之间是不相关的。对于Softmax函数，如果j=2的话，Softmax和Sigmoid是一样的，同样解决的是二分类问题，这时用两种函数都能进行很好的二分类。
对于Softmax回归模型的解释，在这里引用一下别人的图，一张图片就胜过千言万语。

![2017-09-05-17-51-03](http://qiniu.xdpie.com/2017-09-05-17-51-03.png)

如果写成多项式，可以是这样：

![2017-09-05-17-53-51](http://qiniu.xdpie.com/2017-09-05-17-53-51.png)

如果换成我们常用的矩阵的形式，可以是这样：

![2017-09-05-17-58-51](http://qiniu.xdpie.com/2017-09-05-17-58-51.png)



